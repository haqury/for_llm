javascript:(function(){const style=document.createElement('style');style.textContent=`.global-btn{position:fixed;top:20px;right:20px;z-index:9999;background:#3182ce;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,0.3);}.global-btn:hover{background:#2c5282;}.code-collapse-btn{background:#4a5568;color:white;border:none;border-radius:4px;padding:6px 12px;margin:0 10px;cursor:pointer;font-size:12px;}.code-collapse-btn:hover{background:#2d3748;}.header-collapse-btn{background:#e2e8f0;color:#2d3748;border:1px solid #cbd5e0;border-radius:4px;padding:4px 12px;margin-left:15px;cursor:pointer;font-size:12px;}.header-collapse-btn:hover{background:#cbd5e0;}.code-toolbar{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f8fafc;border-bottom:1px solid #e2e8f0;}.hidden-content{display:none!important;}%60;document.head.appendChild(style);let isAllCollapsed=false;const globalBtn=document.createElement('button');globalBtn.className='global-btn';globalBtn.textContent='Свернуть всё';globalBtn.onclick=function(){isAllCollapsed=!isAllCollapsed;this.textContent=isAllCollapsed?'Развернуть всё':'Свернуть всё';document.querySelectorAll('.code-collapse-btn, .header-collapse-btn').forEach(btn=>{if(isAllCollapsed){if(btn.textContent.includes('▼'))btn.click();}else{if(btn.textContent.includes('▶'))btn.click();}});};document.body.appendChild(globalBtn);function addCodeButtons(){document.querySelectorAll('pre').forEach(pre=>{if(pre.dataset.hasCollapseBtn)return;const container=pre.parentElement;const existingToolbar=container.querySelector('.code-toolbar');let toolbar=existingToolbar;if(!toolbar){toolbar=document.createElement('div');toolbar.className='code-toolbar';const rightSection=document.createElement('div');rightSection.style.display='flex';rightSection.style.gap='8px';const copyBtn=container.querySelector('button');if(copyBtn){rightSection.appendChild(copyBtn);}toolbar.appendChild(document.createTextNode('Код'));toolbar.appendChild(rightSection);container.insertBefore(toolbar,pre);}const existingBtn=toolbar.querySelector('.code-collapse-btn');if(existingBtn)return;const btn=document.createElement('button');btn.className='code-collapse-btn';btn.textContent='▼ Свернуть';btn.onclick=function(){pre.classList.toggle('hidden-content');this.textContent=pre.classList.contains('hidden-content')?'▶ Развернуть':'▼ Свернуть';};const rightSection=toolbar.querySelector('div')||toolbar;rightSection.insertBefore(btn,rightSection.firstChild);if(isAllCollapsed){pre.classList.add('hidden-content');btn.textContent='▶ Развернуть';}pre.dataset.hasCollapseBtn='true';});}function addHeaderButtons(){const headers=['h1','h2','h3','h4','h5','h6'];headers.forEach(tag=>{document.querySelectorAll(tag).forEach(header=>{if(header.dataset.hasHeaderBtn)return;const next=header.nextElementSibling;if(!next)return;let content=[next];let el=next.nextElementSibling;while(el&&!el.matches('h1,h2,h3,h4,h5,h6')){content.push(el);el=el.nextElementSibling;}const btn=document.createElement('button');btn.className='header-collapse-btn';btn.textContent='▼ Свернуть';btn.onclick=function(){content.forEach(item=>item.classList.toggle('hidden-content'));this.textContent=this.textContent==='▼'?'▶':'▼';};header.appendChild(btn);if(isAllCollapsed){content.forEach(item=>item.classList.add('hidden-content'));btn.textContent='▶';}header.dataset.hasHeaderBtn='true';});});}function init(){addCodeButtons();addHeaderButtons();}init();setInterval(init,2000);new MutationObserver(init).observe(document.body,{childList:true,subtree:true});})();
